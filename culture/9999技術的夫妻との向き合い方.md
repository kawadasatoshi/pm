






リファクタリングを繰り返してOSS化した話



岩田学

パーソルホールディングス エンゲージメントプロダクト開発部所属
CareerMillを作成。

アクセスはグループ内のみ

グループ内の転職・副業支援を行うのがCarreerMill






「技術的負債の解決事態に価値がある」という結論

プラットフォーム
Terraformはパッケージか

会社が関心を示している


## 敬意

GraphQLを採用している。

- Node.js & TypeScript

- MikrORM

- TypeGraphQL API実装ライブラリ

新しいものを調べてもベストプラクティスがない
ライブラリの機能不足

次のプロダクトで、GraphQLにリベンジ

- Pulumi(ORM)に変更

- 俺俺ライブラリ

相馬さん

オレオレライブラリをやることで、間違った自信を持つ

PlanetGraphQLという名前でOSSとして公開

相馬さんは未経験だったが、ポテンシャルで採用された人

Star:40

目標のStarには届いていない


## 結果

予想としては失敗に終わったが、楽しいのでやめない+価値があると思うのでやめない

## 技術的夫妻

- Kubernetesが高い！


## 技術的夫妻は


@岩田学さん

ご講演いただきありがとうございました。
講演内で出た「PlanetGraphQL」はこちらでしょうか
https://github.com/planet-graphql/planet-graphql



## エンゲージメントプロダクト開発部は..

面白い部である

TeamsやSlackでもTwitterでも良い


## 質問

OSS化したいサービスの



@




# パーソルイノベーションの古川雄大

Teckplay

パーソルイノベーションのバックエンドエンジニアとしてジョイン

「バックエンド」「バッチ処理」を経験

## リプレイスした話

事業的な要望：

技術的夫妻の解消
- バージョンアップ
- ライブラリ

## リファクタリングは？

そもそもアーキテクチャ段階で適していない部分が出てきた。

## メンバー

PdM1

フルスタック4人

社内向け管理サービス

## 既存サービスとの

機能の大幅な変更は行わないこと

- 追加工数を発生させないため

機能の削除はOK

- 顧客とのディスカッションで削除する機能を

CSSフレームワークのデザインを優先する

独自のデザインは極力避ける

## 工夫したこと

リリースによる影響範囲を最小限にする

コンフリクト、デグレを回避する

- 共通のコンポーネントやモデルの先行実装

- リリースサイクルの高速化
    - CI/CDの自動化(Github Actionsを利用した)
    - 個々の開発は知見を持ち、高い技術力を持つエンジニアを当てた
    - 

## リプレイスの結果はどうだったか?

- ルールを決めたことで余剰な開発を防げる

- リリースにより問題が発生したときも着手中の作業を止めずに行うことができた

- テストやCI/CDの自動化を行うことでリリース時にかかる工数を減らせた

- 開発のフォローに入れた

linterを入れることで、ある程度

## 課題

- 開発優先でレビューが止まり、プルリクが塩漬けになった

- **レビュー期間を設けて、プルリクを優先できるようにする**

- ルールを決めた上で、



# 桑田詠士 Seeds Companyについての文化

Seeds Companyは「エンジニアリング組織論への招待」を必ず読んでもらうようになっていた。

## 新規開発を2年とめた

HITO Managerというシステム(ドトール、ファミマ、後楽園が採用)

4~5名が開発を実施

RailsのActive Scaffoldの使用により、開発速度の低下を招いてしまった。

Active Scaffoldを通過リファクタリングを行った。

そうはならなかったんだよ...


## 当時のMGR陣の認知

複雑な仕様が原因なんじゃないの？
というのがMGR陣の認知だった


## 優先度の高い案件が半年後に発生

リファクタリングはうやむやに...


## 再度ヒアリングを実施

その結果、原因は以下の通りだった

- 開発リソースを増やせれない
    - 学習コストを詰めない
        - 膨大な顧客対応
        - 自動テストがない
        - 知見者に思いっきり依存している
- Active Scaffold

の二つであった。

次の目標は、学習リソースを詰めるようにする

## マイクロサービスアンチパターン

フロントエンド1~2

バックエンド4~5

MVC/モノリスによるRailsから

- Go言語のMicroserviceで移行

- 桑田JOINした後。

結果、

- サービスが20個以上

- 一つのサービスを

## アーキテクチャを治せば

「あるべきアーキテクチャ」について2018年12月28日に

年明けにバックエンドエンジニアを集めた

- マイクロサービスを減らす

- CI/CD導入(circleci)

- DDD + Clean Architectureを導入

## 結果

無事期限通りにできる

## 現実

- ビジネス止めてでもリファクタのハードルは、エンジニアが思っている3倍は高い


- 新機能のついでにリファクタ
    - 触らない場所のリファクタはコスパ悪い
    - 工数交渉が楽
      - 定期的なリファクタは、強い意志と交渉力が必須


- 蒸留麺
    - 安易な会報ではなく
    - ビジネスサイドや経営陣への説得力は大事
- 実装面
    - チームには説明しないとわかってもらえない
    - やって見せないとわかってもらえない
    - 

# doda

## 言語

- Java

- AWS

## 仕組み

dodaのシステムは、求人系かユーザー系かで別れるような仕組みで、マイクロサービス


## 課題

- 開発生産性が悪い

  - ローカルでの複数システムの起動に時間がかかる

  - ロジックが複雑で可読性が低い

- MPAによるユーザーへの価値提供の限界

  - フロントエンド領域の



## 結論(どう対応したか)

ぶっちゃけ、フロントエンドとバックエンドとDBだけでいい

(ユーザー情報DBと通常DB)

## まもりのリファクタリング

既存コードを悪化させない

- SonarQubeを導入した
    - システムの品質を可視化して効率的にリファクタリングをする
    - リリースの都度、追加されたコードの品質を確認し問題があれば対応する

- テストコードの定着か
    - CIを設定しテストを強制的に意識せざるを得ない環境づくり
    - カバレッジの可視化によるテスト品質の向上

## 攻めのりアーキテクティング


































